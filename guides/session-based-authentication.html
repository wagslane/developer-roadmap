<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta content="Astro v2.1.2" name=generator><meta content=https://github.com/kamranahmedse/developer-roadmap/commit/3d655965f628763429b3c3cb967d95e7da273b18 name=commit><title>Session Based Authentication - roadmap.sh</title><meta content="Learn what is Session Based Authentication and how to implement it in Node.js" name=description><meta content="Kamran Ahmed" name=author><meta content="roadmap, developer roadmaps, developer roadmap, how to become a developer, frontend developer roadmap, frontend developer roadmap 2023, backend developer roadmap, backend developer roadmap 2023, sre roadmap, sre roadmap 2023, devops roadmap, devops roadmap 2023, android developer roadmap, android developer roadmap 2023, dba roadmap, dba roadmap 2023, blockchain developer roadmap, blockchain developer roadmap 2023, qa roadmap, qa roadmap 2023, qa engineer roadmap, qa engineer roadmap 2023, software architect roadmap, software architect roadmap 2023, asp.net core developer roadmap, asp.net core developer roadmap 2023, react developer roadmap, react developer roadmap 2023, angular developer roadmap, angular developer roadmap 2023, vue developer roadmap, vue developer roadmap 2023, node.js developer roadmap, node.js developer roadmap 2023, javascript developer roadmap, javascript developer roadmap 2023, python developer roadmap, python developer roadmap 2023, go developer roadmap, go developer roadmap 2023, java developer roadmap, java developer roadmap 2023, design system roadmap, design system roadmap 2023, software design roadmap, software design roadmap 2023, graphql roadmap, graphql roadmap 2023" name=keywords><meta content="width=device-width,user-scalable=yes,initial-scale=1,maximum-scale=3,minimum-scale=1" name=viewport><meta content=en http-equiv=Content-Language><meta content=summary_large_image name=twitter:card><meta content=@kamranahmedse name=twitter:creator><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><meta content=https://roadmap.sh/images/og-img.png property=og:image><meta content=roadmap.sh property=og:image:alt><meta content=roadmap.sh property=og:site_name><meta content="Session Based Authentication - roadmap.sh" property=og:title><meta content="Learn what is Session Based Authentication and how to implement it in Node.js" property=og:description><meta content=website property=og:type><meta content=https://roadmap.sh/guides/session-based-authentication property=og:url><link href=https://roadmap.sh/guides/session-based-authentication rel=canonical><meta content=yes name=mobile-web-app-capable><meta content=yes name=apple-mobile-web-app-capable><meta content=black-translucent name=apple-mobile-web-app-status-bar-style><meta content=roadmap.sh name=apple-mobile-web-app-title><meta content=roadmap.sh name=application-name><link href=/manifest/apple-touch-icon.png rel=apple-touch-icon sizes=180x180><meta content=#101010 name=msapplication-TileColor><meta content=#848a9a name=theme-color><link href=/manifest/manifest.json rel=manifest><link href=/manifest/icon32.png rel=icon type=image/png sizes=32x32><link href=/manifest/icon16.png rel=icon type=image/png sizes=16x16><link href=/manifest/favicon.ico rel="shortcut icon" type=image/x-icon><link href=/manifest/favicon.ico rel=icon type=image/x-icon><link href=/_astro/pdfs.302e2d20.css rel=stylesheet /><script src=/_astro/hoisted.a1797f3a.js type=module></script></head><body><div class="flex border-b border-b-yellow-300 h-[37px] z-20" youtube-banner><a href="https://youtube.com/theroadmap?sub_confirmation=1" class="items-center flex bg-yellow-200 flex-1 hover:bg-yellow-300 justify-center outline-0 text-center text-sm" target=_blank><svg viewBox="0 0 24 24" xmlns=http://www.w3.org/2000/svg fill=currentColor class=mr-2 height=20 width=20 xmlns:v=https://vecta.io/nano><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0C.488 3.45.029 5.804 0 12c.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0C23.512 20.55 23.971 18.196 24 12c-.029-6.185-.484-8.549-4.385-8.816zM9 16V8l8 3.993L9 16z"></path></svg> We now have a YouTube Channel.&nbsp;<span class="hidden sm:inline">Subscribe for the video content.</span> </a><button aria-label=Close class="hover:bg-yellow-400 bg-yellow-200 hover:text-yellow-900 outline-0 px-2 text-yellow-500" close-youtube-banner><svg viewBox="0 0 20 20" xmlns=http://www.w3.org/2000/svg fill=currentColor class="h-5 w-5" aria-hidden=true><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule=evenodd fill-rule=evenodd></path></svg></button></div><div class="text-white bg-slate-900 py-5 sm:py-8"><nav class="items-center flex container justify-between"><a href=/ class="items-center flex font-medium text-lg text-white"><svg viewBox="0 0 283 283" xmlns=http://www.w3.org/2000/svg fill=#000 height=30 width=30 xmlns:v=https://vecta.io/nano><path d="M0 39C0 17.46 17.46 0 39 0h205c21.539 0 39 17.46 39 39v205c0 21.539-17.461 39-39 39H39c-21.54 0-39-17.461-39-39V39Z" fill=#fff></path><path d="M121.215 210.72c-1.867.56-4.854 1.12-8.96 1.68-3.92.56-8.027.84-12.32.84-4.107 0-7.84-.28-11.2-.84-3.174-.56-5.88-1.68-8.12-3.36s-4.014-3.92-5.32-6.72c-1.12-2.987-1.68-6.813-1.68-11.48v-84c0-4.293.746-7.933 2.24-10.92 1.68-3.173 4.013-5.973 7-8.4s6.626-4.573 10.92-6.44c4.48-2.053 9.24-3.827 14.28-5.32a106.176 106.176 0 0 1 15.68-3.36 95.412 95.412 0 0 1 16.24-1.4c8.96 0 16.053 1.773 21.28 5.32 5.226 3.36 7.84 8.96 7.84 16.8 0 2.613-.374 5.227-1.12 7.84-.747 2.427-1.68 4.667-2.8 6.72a133.1 133.1 0 0 0-12.04.56c-4.107.373-8.12.933-12.04 1.68s-7.654 1.587-11.2 2.52c-3.36.747-6.254 1.68-8.68 2.8v95.48zm45.172-22.4c0-7.84 2.426-14.373 7.28-19.6s11.48-7.84 19.88-7.84 15.026 2.613 19.88 7.84 7.28 11.76 7.28 19.6-2.427 14.373-7.28 19.6-11.48 7.84-19.88 7.84-15.027-2.613-19.88-7.84-7.28-11.76-7.28-19.6z"></path></svg> <span class=ml-3>roadmap.sh</span></a><ul class="hidden sm:flex space-x-5"><li><a href=/roadmaps class="hover:text-white text-gray-400">Roadmaps</a></li><li><a href=/best-practices class="hover:text-white text-gray-400">Best Practices</a></li><li><a href=/guides class="hover:text-white text-gray-400">Guides</a></li><li><a href=/videos class="hover:text-white text-gray-400">Videos</a></li><li><a href=/signup class="text-sm font-regular bg-gradient-to-r from-blue-500 hover:from-blue-500 hover:to-blue-600 px-4 py-2 rounded-full text-white to-blue-700">Subscribe</a></li></ul><button aria-label=Menu class="text-gray-400 block cursor-pointer hover:text-gray-50 sm:hidden" show-mobile-nav><svg viewBox="0 0 24 24" class="h-5 w-5" aria-hidden=true focusable=false><path d="M 3 5 A 1.0001 1.0001 0 1 0 3 7 L 21 7 A 1.0001 1.0001 0 1 0 21 5 L 3 5 z M 3 11 A 1.0001 1.0001 0 1 0 3 13 L 21 13 A 1.0001 1.0001 0 1 0 21 11 L 3 11 z M 3 17 A 1.0001 1.0001 0 1 0 3 19 L 21 19 A 1.0001 1.0001 0 1 0 21 17 L 3 17 z" fill=currentColor></path></svg></button><div class="items-center flex bg-slate-900 bottom-0 fixed hidden left-0 right-0 top-0 z-40" mobile-nav><button aria-label="Close Menu" class="text-gray-400 block cursor-pointer hover:text-gray-50 absolute right-6 top-6" close-mobile-nav><svg viewBox="0 0 20 20" xmlns=http://www.w3.org/2000/svg fill=currentColor class="h-5 w-5" aria-hidden=true><path d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule=evenodd fill-rule=evenodd></path></svg></button><ul class="items-center flex flex-col gap-2 md:gap-3 w-full"><li><a href=/roadmaps class="md:text-lg text-xl hover:text-blue-300">Roadmaps</a></li><li><a href=/best-practices class="md:text-lg text-xl hover:text-blue-300">Best Practices</a></li><li><a href=/guides class="md:text-lg text-xl hover:text-blue-300">Guides</a></li><li><a href=/videos class="md:text-lg text-xl hover:text-blue-300">Videos</a></li><li><a href=/signup class="md:text-lg text-xl hover:text-red-400 text-red-300">Subscribe</a></li></ul></div></nav></div><div class="border-b bg-white py-5 sm:py-12"><div class="container sm:text-center text-left"><p class="text-gray-400 hidden items-center justify-start sm:flex sm:justify-center"><a href=https://twitter.com/kamranahmedse class="items-center inline-flex font-medium hover:text-gray-600 hover:underline" target=_blank><img alt="Kamran Ahmed" class="h-5 w-5 inline mr-2 rounded-full" src=/authors/kamranahmedse.jpeg> Kamran Ahmed </a><span class=mx-1.5>&middot;</span> <span class=capitalize>textual Guide</span> <span class=mx-1.5>&middot;</span> <a href=https://github.com/kamranahmedse/roadmap.sh/tree/master/src/data/guides/session-based-authentication.md class="hover:underline hover:text-blue-500 text-blue-400" target=_blank>Improve this Guide</a></p><h1 class="font-bold sm:text-5xl text-2xl my-0 sm:my-3.5">Session Based Authentication</h1><p class="text-gray-400 hidden sm:block text-md">Learn what is Session Based Authentication and how to implement it in Node.js</p></div></div><div class="py-5 bg-gray-50 sm:py-10"><div class="container prose prose-blockquote:font-normal prose-code:bg-transparent prose-h2:mb-2 prose-h2:mt-4 prose-h2:text-3xl prose-h3:mt-2 prose-img:mt-1"><p>HTTP is the internet protocol that standardizes how clients and servers interact with each other. When you open a website, among other things, HTTP is the protocol that helps load the website in the browser.</p><h2 id=http-is-stateless>HTTP is Stateless</h2><p>HTTP is a stateless protocol which means that each request made from the client to the server is treated as a standalone request; neither the client nor the server keeps track of the subsequent requests. Sessions allow you to change that; with sessions, the server has a way to associate some information with the client so that when the same client requests the server, it can retrieve that information.</p><p>In this guide, we will learn what is Session-Based Authentication and how to implement it in Node.js. We also have a separate <a href=/guides/session-authentication>visual guide on Session-Based Authentication</a> as well that explains the topic visually.</p><h2 id=what-is-session-based-authentication>What is Session-Based Authentication?</h2><p>Session-based authentication is a stateful authentication technique where we use sessions to keep track of the authenticated user. Here is how Session Based Authentication works:</p><ul><li>User submits the login request for authentication.</li><li>Server validates the credentials. If the credentials are valid, the server initiates a session and stores some information about the client. This information can be stored in memory, file system, or database. The server also generates a unique identifier that it can later use to retrieve this session information from the storage. Server sends this unique session identifier to the client.</li><li>Client saves the session id in a cookie and this cookie is sent to the server in each request made after the authentication.</li><li>Server, upon receiving a request, checks if the session id is present in the request and uses this session id to get information about the client.</li></ul><p>And that is how session-based authentication works.</p><h2 id=session-based-authentication-in-nodejs>Session-Based Authentication in Node.js</h2><p>Now that we know what session-based authentication is, let’s see how we can implement session-based authentication in Node.js.</p><p>Please note that, for the sake of simplicity, I have intentionally kept the project strictly relevant to the Session Based Authentication and have left out a lot of details that a production-ready application may require. Also, if you don’t want to follow along, project <a href=https://github.com/kamranahmedse/node-session-auth-example target=_blank rel=nofollow>codebase can be found on GitHub</a>.</p><p>First things first, create an empty directory that will be holding our application.</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#f8f8f2>mkdir session-auth-example</span></span></code></pre><p>Now run the following command to setup a sample <code>package.json</code> file:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#f8f8f2>npm init -y</span></span></code></pre><p>Next, we need to install the dependencies:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#f8f8f2>npm install express express-session</span></span></code></pre><p><code>Express</code> is the application framework, and <code>express-session</code> is the package that helps work with sessions easily.</p><h3 id=setting-up-the-server>Setting up the server</h3><p>Now create an <code>index.js</code> file at the root of the project with the following content:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> express </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>express</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> sessions </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>express-session</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> app </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>express</span><span style=color:#f8f8f2>();</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>use</span><span style=color:#f8f8f2>(</span><span style=color:#50fa7b>sessions</span><span style=color:#f8f8f2>({</span></span>
<span class=line><span style=color:#f8f8f2>  secret</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>"</span><span style=color:#f1fa8c>some secret</span><span style=color:#e9f284>"</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>  cookie</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> {</span></span>
<span class=line><span style=color:#f8f8f2>    maxAge</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>1000</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>*</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>60</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>*</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>60</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>*</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>24</span><span style=color:#f8f8f2> </span><span style=color:#6272a4>// 24 hours</span></span>
<span class=line><span style=color:#f8f8f2>  },</span></span>
<span class=line><span style=color:#f8f8f2>  resave</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>true</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>  saveUninitialized</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>false</span><span style=color:#f8f8f2>,</span></span>
<span class=line><span style=color:#f8f8f2>}));</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>use</span><span style=color:#f8f8f2>(express.</span><span style=color:#50fa7b>json</span><span style=color:#f8f8f2>());</span></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>use</span><span style=color:#f8f8f2>(express.</span><span style=color:#50fa7b>urlencoded</span><span style=color:#f8f8f2>({extended</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#bd93f9>true</span><span style=color:#f8f8f2>}));</span></span>
<span class=line></span>
<span class=line><span style=color:#6272a4>// @todo register routes</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>listen</span><span style=color:#f8f8f2>(</span><span style=color:#bd93f9>3000</span><span style=color:#f8f8f2>, () </span><span style=color:#ff79c6>=></span><span style=color:#f8f8f2> {</span></span>
<span class=line><span style=color:#f8f8f2>  console.</span><span style=color:#50fa7b>log</span><span style=color:#f8f8f2>(</span><span style=color:#f1fa8c>`Server Running at port 3000`</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#f8f8f2>});</span></span></code></pre><p>The important piece to note here is the <code>express-session</code> middleware registration which automatically handles the session initialization, cooking parsing and session data retrieval, and so on. In our example here, we are passing the following configuration options:</p><ul><li><code>secret</code>: This is used to sign the session ID cookie. Using a secret that cannot be guessed will reduce the ability to hijack a session.</li><li><code>cookie</code>: Object containing the configuration for session id cookie.</li><li><code>resave</code>: Forces the session to be saved back to the session store, even if the session data was never modified during the request.</li><li><code>saveUninitialized</code>: Forces an “uninitialized” session to be saved to the store, i.e., saves a session to the store even if the session was not initiated.</li></ul><p>Another important option is <code>store</code> which we can configure to change how/where the session data is stored on the server. By default, this data is stored in the memory, i.e., <code>MemoryStore</code>.</p><p>Look at the <a href=https://github.com/expressjs/session target=_blank rel=nofollow>express-session documentation</a> to learn more about the available options.</p><h3 id=creating-handlers>Creating Handlers</h3><p>Create a directory called the <code>handlers</code> at the project’s root. This is the directory where we will be placing all the route-handling functions.</p><p>Now let’s create the homepage route, which will show the welcome message and a link to log out for the logged-in users and redirect to the login screen for the logged-out users. Create a file at <code>handlers/home.js</code> with the following content.</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#8be9fd>module</span><span style=color:#f8f8f2>.</span><span style=color:#8be9fd>exports</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>function</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>HomeHandler</span><span style=color:#f8f8f2>(</span><span style=color:#ffb86c>req</span><span style=color:#f8f8f2>, </span><span style=color:#ffb86c>res</span><span style=color:#f8f8f2>) {</span></span>
<span class=line><span style=color:#f8f8f2>  </span><span style=color:#ff79c6>if</span><span style=color:#f8f8f2> (</span><span style=color:#ff79c6>!</span><span style=color:#f8f8f2>req.session.userid) {</span></span>
<span class=line><span style=color:#f8f8f2>    </span><span style=color:#ff79c6>return</span><span style=color:#f8f8f2> res.</span><span style=color:#50fa7b>redirect</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/login</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#f8f8f2>  }</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>setHeader</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>Content-Type</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>text/HTML</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>)</span></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>write</span><span style=color:#f8f8f2>(</span><span style=color:#f1fa8c>`</span></span>
<span class=line><span style=color:#f1fa8c>    &#x3C;h1>Welcome back </span><span style=color:#ff79c6>${</span><span style=color:#f8f8f2>req.session.userid</span><span style=color:#ff79c6>}</span><span style=color:#f1fa8c>&#x3C;/h1></span></span>
<span class=line><span style=color:#f1fa8c>    &#x3C;a href="/logout">Logout&#x3C;/a></span></span>
<span class=line><span style=color:#f1fa8c>  `</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>end</span><span style=color:#f8f8f2>()</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>At the top of this function, you will notice the check <code>req.session.userid</code>. <code>req.session</code> is automatically populated using the session cookie by the <code>express-session</code> middleware that we registered earlier. <code>req.session.userid</code> is one of the data fields that we will set to store the <code>userid</code> of the logged in user.</p><p>Next, we need to register this handler with a route. Open the <code>index.js</code> file at the root of the project and register the following route:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> HomeHandler </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>./handlers/home.js</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>get</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, HomeHandler);</span></span></code></pre><p>Next, we have the login page, redirecting the user to the home screen if the user is logged in or showing the login form. Create a file at <code>handlers/login.js</code> with the following content:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#8be9fd>module</span><span style=color:#f8f8f2>.</span><span style=color:#8be9fd>exports</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>function</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>LoginHandler</span><span style=color:#f8f8f2>(</span><span style=color:#ffb86c>req</span><span style=color:#f8f8f2>, </span><span style=color:#ffb86c>res</span><span style=color:#f8f8f2>) {</span></span>
<span class=line><span style=color:#f8f8f2>  </span><span style=color:#ff79c6>if</span><span style=color:#f8f8f2> (req.session.userid) {</span></span>
<span class=line><span style=color:#f8f8f2>    </span><span style=color:#ff79c6>return</span><span style=color:#f8f8f2> res.</span><span style=color:#50fa7b>redirect</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#f8f8f2>  }</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>setHeader</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>Content-Type</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>text/HTML</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>)</span></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>write</span><span style=color:#f8f8f2>(</span><span style=color:#f1fa8c>`</span></span>
<span class=line><span style=color:#f1fa8c>    &#x3C;h1>Login&#x3C;/h1></span></span>
<span class=line><span style=color:#f1fa8c>    &#x3C;form method="post" action="/process-login"></span></span>
<span class=line><span style=color:#f1fa8c>      &#x3C;input type="text" name="username" placeholder="Username" /> &#x3C;br></span></span>
<span class=line><span style=color:#f1fa8c>      &#x3C;input type="password" name="password" placeholder="Password" /> &#x3C;br></span></span>
<span class=line><span style=color:#f1fa8c>      &#x3C;button type="submit">Login&#x3C;/button></span></span>
<span class=line><span style=color:#f1fa8c>    &#x3C;/form></span></span>
<span class=line><span style=color:#f1fa8c>  `</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>end</span><span style=color:#f8f8f2>();</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>Again, at the top of the function, we are simply checking if we have <code>userid</code> in the session (which means the user is logged in). If the user is logged in, we redirect them to the homepage; if not, we show the login screen. In the login form, we have the method of <code>post</code>, and we submit the form to <code>/process-login</code>. Please note that, for the sake of simplicity, we have a simple HTML string returned in the response, but in a real-world application, you will probably have a separate view file.</p><p>Let’s first register this page and then implement <code>/process-login</code> endpoint. Open the <code>index.js</code> file from the root of the project and register the following route:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> LoginHandler </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>./handlers/login.js</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>get</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/login</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, LoginHandler);</span></span></code></pre><p>Next, we have to implement the functionality to process the login form submissions. Create a file at <code>handlers/process-login.js</code> with the following content:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#8be9fd>module</span><span style=color:#f8f8f2>.</span><span style=color:#8be9fd>exports</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>function</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>processLogin</span><span style=color:#f8f8f2>(</span><span style=color:#ffb86c>req</span><span style=color:#f8f8f2>, </span><span style=color:#ffb86c>res</span><span style=color:#f8f8f2>) {</span></span>
<span class=line><span style=color:#f8f8f2>  </span><span style=color:#ff79c6>if</span><span style=color:#f8f8f2> (req.body.username </span><span style=color:#ff79c6>!==</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>admin</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>||</span><span style=color:#f8f8f2> req.body.password </span><span style=color:#ff79c6>!==</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>admin</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>) {</span></span>
<span class=line><span style=color:#f8f8f2>    </span><span style=color:#ff79c6>return</span><span style=color:#f8f8f2> res.</span><span style=color:#50fa7b>send</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>Invalid username or password)</span><span style=color:#f55;font-weight:700>;</span></span>
<span class=line><span style=color:#f8f8f2>  }</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  req.session.userid </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> req.body.username;</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>redirect</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>As you can see, we are simply checking that the username and password should both be <code>admin</code> and <code>admin</code> for a user to authenticate successfully. Upon finding valid credentials, we set the <code>userid</code> in the session by updating <code>req.session.userid</code>. Similarly, you can set any data in the session. For example, if we wanted to store the user role, we would do the following:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#f8f8f2>req.session.role </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>admin</span><span style=color:#e9f284>'</span></span></code></pre><p>And later access this value out of the session anywhere in the subsequent requests.</p><p>Register this route in the <code>index.js</code> file at the root of the project:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> ProcessLoginHandler </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>./handlers/process-login.js</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>post</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/process-login</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, ProcessLoginHandler);</span></span></code></pre><p>Finally, we have the logout functionality. Create a file at <code>handlers/logout.js</code> with the following content:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#8be9fd>module</span><span style=color:#f8f8f2>.</span><span style=color:#8be9fd>exports</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#ff79c6>function</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>Logout</span><span style=color:#f8f8f2>(</span><span style=color:#ffb86c>req</span><span style=color:#f8f8f2>, </span><span style=color:#ffb86c>res</span><span style=color:#f8f8f2>)  {</span></span>
<span class=line><span style=color:#f8f8f2>  req.session.</span><span style=color:#50fa7b>destroy</span><span style=color:#f8f8f2>();</span></span>
<span class=line><span style=color:#f8f8f2>  res.</span><span style=color:#50fa7b>redirect</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line><span style=color:#f8f8f2>}</span></span></code></pre><p>We reset the session by calling <code>req.session.destroy()</code> and then redirecting the user to the homepage. Register the logout handler in the <code>index.js</code> file using the following:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#ff79c6>const</span><span style=color:#f8f8f2> LogoutHandler </span><span style=color:#ff79c6>=</span><span style=color:#f8f8f2> </span><span style=color:#50fa7b>require</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>./handlers/logout.js</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>);</span></span>
<span class=line></span>
<span class=line><span style=color:#f8f8f2>app.</span><span style=color:#50fa7b>get</span><span style=color:#f8f8f2>(</span><span style=color:#e9f284>'</span><span style=color:#f1fa8c>/logout</span><span style=color:#e9f284>'</span><span style=color:#f8f8f2>, LogoutHandler);</span></span></code></pre><h2 id=running-the-application>Running the Application</h2><p>Open the <code>package.json</code> file and register the <code>start</code> script as follows:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#e9f284>"</span><span style=color:#f1fa8c>scripts</span><span style=color:#e9f284>"</span><span style=color:#f8f8f2>: {</span></span>
<span class=line><span style=color:#f8f8f2>  </span><span style=color:#e9f284>"</span><span style=color:#f1fa8c>start</span><span style=color:#e9f284>"</span><span style=color:#ff79c6>:</span><span style=color:#f8f8f2> </span><span style=color:#e9f284>"</span><span style=color:#f1fa8c>node index.js</span><span style=color:#e9f284>"</span></span>
<span class=line><span style=color:#f8f8f2>},</span></span></code></pre><p>Now you can start the application by running the following command:</p><pre class=astro-code is:raw="" style=background-color:#282a36;overflow-x:auto><code><span class=line><span style=color:#f8f8f2>npm run start</span></span></code></pre><p>Now, if you open up your browser and visit the project at <code>http://localhost:3000</code> you will be able to see the Session-Based Authentication in action.</p></div></div><div class="border-b bg-white border-t py-6 sm:py-16 sm:text-center text-left"><div class="container max-w-[600px]"><h2 class="font-bold sm:text-5xl text-2xl">Open Source</h2><p class="text-sm leading-relaxed my-2.5 sm:my-5 sm:text-lg text-gray-600">The project is OpenSource, <a href="https://github.com/search?o=desc&q=stars%3A%3E100000&s=stars&type=Repositories" class="text-gray-600 font-medium hover:text-black underline underline-offset-2" target=_blank>6th most starred project on GitHub</a> and is visited by hundreds of thousands of developers every month.</p><div class="block mb-1.5 sm:mb-0"><a href=https://github.com/kamranahmedse/developer-roadmap class="items-center inline-flex relative group rounded-md" target=_blank><span class="items-center inline-flex relative bg-white border border-black group-hover:bg-black group-hover:text-white px-3 py-1.5 rounded-lg text-sm"><div class="-ml-1 mr-1"><svg viewBox="0 0 14 15" xmlns=http://www.w3.org/2000/svg class="fill-current h-4 w-4" height=15 width=14 focusable=false><path d="M6.99999 11.1515L2.88574 13.4545L3.80449 8.82984L0.342407 5.6285L5.02482 5.07317L6.99999 0.791504L8.97516 5.07317L13.6576 5.6285L10.1955 8.82984L11.1142 13.4545L6.99999 11.1515Z"></path></svg></div><span class=lowercase>233K</span> <span class="group-hover:hidden ml-1.5">GitHub Stars</span> <span class="hidden group-hover:block ml-2">Star us on GitHub</span></span></a></div></div></div><div class="text-white bg-slate-900 pb-10 py-6 sm:py-16"><div class=container><p class="text-gray-400 flex flex-col font-medium gap-0 justify-center mb-8 sm:flex-row sm:gap-4 sm:mb-16"><a href=/roadmaps class="hover:text-white px-2 py-1.5 sm:border-b-0 sm:px-0 sm:py-0 transition-colors border-b border-b-gray-700">Roadmaps</a> <a href=/guides class="hover:text-white px-2 py-1.5 sm:border-b-0 sm:px-0 sm:py-0 transition-colors border-b border-b-gray-700">Guides</a> <a href=/videos class="hover:text-white px-2 py-1.5 sm:border-b-0 sm:px-0 sm:py-0 transition-colors border-b border-b-gray-700">Videos</a> <a href=/about class="hover:text-white px-2 py-1.5 sm:border-b-0 sm:px-0 sm:py-0 transition-colors border-b border-b-gray-700">About</a> <a href="https://youtube.com/theroadmap?sub_confirmation=1" class="hover:text-white px-2 py-1.5 sm:border-b-0 sm:px-0 sm:py-0 transition-colors" target=_blank>YouTube</a></p><div class="flex flex-col sm:flex-row gap-12 justify-between"><div class=max-w-[365px]><p class="items-center flex text-md"><a href=/ class="items-center inline-flex font-medium hover:text-gray-400 text-lg text-white transition-colors"><svg viewBox="0 0 283 283" xmlns=http://www.w3.org/2000/svg fill=#000 height=30 width=30 xmlns:v=https://vecta.io/nano><path d="M0 39C0 17.46 17.46 0 39 0h205c21.539 0 39 17.46 39 39v205c0 21.539-17.461 39-39 39H39c-21.54 0-39-17.461-39-39V39Z" fill=#fff></path><path d="M121.215 210.72c-1.867.56-4.854 1.12-8.96 1.68-3.92.56-8.027.84-12.32.84-4.107 0-7.84-.28-11.2-.84-3.174-.56-5.88-1.68-8.12-3.36s-4.014-3.92-5.32-6.72c-1.12-2.987-1.68-6.813-1.68-11.48v-84c0-4.293.746-7.933 2.24-10.92 1.68-3.173 4.013-5.973 7-8.4s6.626-4.573 10.92-6.44c4.48-2.053 9.24-3.827 14.28-5.32a106.176 106.176 0 0 1 15.68-3.36 95.412 95.412 0 0 1 16.24-1.4c8.96 0 16.053 1.773 21.28 5.32 5.226 3.36 7.84 8.96 7.84 16.8 0 2.613-.374 5.227-1.12 7.84-.747 2.427-1.68 4.667-2.8 6.72a133.1 133.1 0 0 0-12.04.56c-4.107.373-8.12.933-12.04 1.68s-7.654 1.587-11.2 2.52c-3.36.747-6.254 1.68-8.68 2.8v95.48zm45.172-22.4c0-7.84 2.426-14.373 7.28-19.6s11.48-7.84 19.88-7.84 15.026 2.613 19.88 7.84 7.28 11.76 7.28 19.6-2.427 14.373-7.28 19.6-11.48 7.84-19.88 7.84-15.027-2.613-19.88-7.84-7.28-11.76-7.28-19.6z"></path></svg> <span class=ml-2>roadmap.sh</span> </a><span class="text-gray-400 mx-2">by</span> <a href="https://twitter.com/intent/user?screen_name=kamranahmedse" class="text-sm font-regular bg-blue-600 hover:bg-blue-700 px-1.5 py-1 rounded-md" target=_blank><span class="hidden sm:inline">@kamranahmedse</span> <span class="inline sm:hidden">Kamran Ahmed</span></a></p><p class="my-4 text-slate-300/60">Community created roadmaps, articles, resources and journeys to help you choose your path and grow in your career.</p><div class="text-gray-400 text-sm"><p>&copy; roadmap.sh <span class=mx-1.5>&middot;</span> <a href=/about class=hover:text-white>FAQs</a> <span class=mx-1.5>&middot;</span> <a href=/terms class=hover:text-white>Terms</a> <span class=mx-1.5>&middot;</span> <a href=/privacy class=hover:text-white>Privacy</a></p></div></div><div class="text-left max-w-[365px] sm:text-right"><a href=https://thenewstack.io target=_blank><img alt=ThewNewStack class="mr-auto my-1.5 sm:ml-auto sm:mr-0" src=/images/tns-sm.png height=24.8 width=200></a><p class="my-4 text-slate-300/60">The leading DevOps resource for Kubernetes, cloud-native computing, and the latest in at-scale development, deployment, and management.</p><div class="text-gray-400 text-sm"><p><a href="https://thenewstack.io/category/devops?utm_source=roadmap.sh&utm_medium=Referral&utm_campaign=Footer" class="hover:text-white text-gray-400" target=_blank ga-action="TNS Referral" ga-category=PartnerClick ga-label="TNS Referral - Footer">DevOps</a> <span class=mx-1.5>&middot;</span> <a href="https://thenewstack.io/category/kubernetes?utm_source=roadmap.sh&utm_medium=Referral&utm_campaign=Footer" class="hover:text-white text-gray-400" target=_blank ga-action="TNS Referral" ga-category=PartnerClick ga-label="TNS Referral - Footer">Kubernetes</a> <span class=mx-1.5>&middot;</span> <a href="https://thenewstack.io/category/cloud-native?utm_source=roadmap.sh&utm_medium=Referral&utm_campaign=Footer" class="hover:text-white text-gray-400" target=_blank ga-action="TNS Referral" ga-category=PartnerClick ga-label="TNS Referral - Footer">Cloud-Native</a></p></div></div></div></div></div><script src="https://www.googletagmanager.com/gtag/js?id=UA-139582634-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-139582634-1"),document.addEventListener("click",(t=>{let e=t.target;if(e.getAttribute("ga-category")||(e=e.closest("[ga-category]")),!e)return;const a=e.getAttribute("ga-category"),g=e.getAttribute("ga-action"),r=e.getAttribute("ga-label");a&&window.fireEvent({category:a,action:g,label:r})}))</script></body></html>